<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Senhas</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="shortcut icon" type="imagex/png" href="./GS.jd.png">
</head>

<body>
    <div class="container">
        <h1>Gerador de Senhas<small>.JD</small></h1>
        <select id="nivel">
            <option value="facil">Fácil </option>
            <option value="medio">Médio </option>
            <option value="dificil">Difícil </option>
        </select>
        <button onclick="gerarSenha()">Gerar Senha</button>
        <p id="senha"></p>
        <button id="btnHistorico" onclick="toggleHistorico()">Mostrar Histórico</button>
        <div id="historico"></div>
    </div>

    <button id="toggleTema" onclick="toggleTema()">Alternar Tema</button>

    <footer>
        <p>© 2025 Todos os direitos reservados a <a href="https://github.com/ZeDio">José Diogo</a></p>
    </footer>

    <script src="./script.js"></script>
    <script>
        const senhaEl = document.getElementById("senha");
        const historicoEl = document.getElementById("historico");
        const btnHistorico = document.getElementById("btnHistorico");

        function gerarSenha() {
            const nivel = document.getElementById("nivel").value;
            let caracteres = "abcdefghijklmnopqrstuvwxyz";
            if (nivel === "medio") caracteres += "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
            if (nivel === "dificil") caracteres += "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+";

            let senha = "";
            for (let i = 0; i < 10; i++) {
                senha += caracteres.charAt(Math.floor(Math.random() * caracteres.length));
            }

            senhaEl.textContent = senha;
            salvarSenha(senha);
        }

        function salvarSenha(senha) {
            let historico = JSON.parse(localStorage.getItem("historicoSenhas")) || [];
            historico.push(senha);
            localStorage.setItem("historicoSenhas", JSON.stringify(historico));
            atualizarHistorico(true);
        }

        function atualizarHistorico(isNova = false) {
            let historico = JSON.parse(localStorage.getItem("historicoSenhas")) || [];
            historicoEl.innerHTML = "";
            historico.forEach((senha, index) => {
                const div = document.createElement("div");
                div.classList.add("senha-item");
                if (isNova && index === historico.length - 1) {
                    div.classList.add("nova"); // anima apenas a última adicionada
                }
                div.innerHTML = `${senha} <button onclick="removerSenha(${index}, this)">❌</button>`;
                historicoEl.appendChild(div);
            });
        }

        function removerSenha(index, btn) {
            let historico = JSON.parse(localStorage.getItem("historicoSenhas")) || [];
            const div = btn.parentElement;
            div.classList.add("removendo");

            setTimeout(() => {
                historico.splice(index, 1);
                localStorage.setItem("historicoSenhas", JSON.stringify(historico));
                atualizarHistorico();
            }, 400);
        }

        function toggleHistorico() {
            historicoEl.classList.toggle("show");
            if (historicoEl.classList.contains("show")) {
                atualizarHistorico();
                btnHistorico.textContent = "Ocultar Histórico";
            } else {
                btnHistorico.textContent = "Mostrar Histórico";
            }
        }

        function toggleTema() {
            const body = document.body;
            if (body.classList.contains("dark")) {
                body.classList.remove("dark");
                body.classList.add("light");
                localStorage.setItem("tema", "light");
            } else {
                body.classList.remove("light");
                body.classList.add("dark");
                localStorage.setItem("tema", "dark");
            }
        }

        window.onload = () => {
            const tema = localStorage.getItem("tema") || "dark";
            document.body.classList.add(tema);
        };
    </script>
</body>

</html>